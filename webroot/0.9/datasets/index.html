

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6. Dataset loading utilities &mdash; scikit-learn 0.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="scikit-learn 0.9 documentation" href="../index.html" />
    <link rel="up" title="&lt;no title&gt;" href="../contents.html" />
    <link rel="next" title="7. Preprocessing data" href="../modules/preprocessing.html" />
    <link rel="prev" title="9.2.12. sklearn.linear_model.LassoLarsIC" href="../modules/generated/sklearn.linear_model.LassoLarsIC.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22606712-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../index.html">
            <img src="../_static/scikit-learn-logo-small.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../install.html">Download</a></li>
            <li><a href="../support.html">Support</a></li>
            <li><a href="../user_guide.html">User Guide</a></li>
            <li><a href="../auto_examples/index.html">Examples</a></li>
            <li><a href="../developers/index.html">Development</a></li>
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">
  google.load('search', '1', {language : 'en'});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    var options = new google.search.DrawOptions();
    options.setAutoComplete(true);
    customSearchControl.draw('cse', options);
  }, true);
</script>

</div>

          </div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

    <!-- <div id="blue_tile"></div> -->

        <div class="sphinxsidebar">
        <div class="rel">
          <a href="../modules/generated/sklearn.linear_model.LassoLarsIC.html" title="9.2.12. sklearn.linear_model.LassoLarsIC"
             accesskey="P">previous</a> |
          <a href="../modules/preprocessing.html" title="7. Preprocessing data"
             accesskey="N">next</a> |
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
        

        <h3>This page</h3>
         <ul>
<li><a class="reference internal" href="#">6. Dataset loading utilities</a><ul>
<li><a class="reference internal" href="#toy-datasets">6.1. Toy datasets</a></li>
<li><a class="reference internal" href="#sample-images">6.2. Sample images</a></li>
<li><a class="reference internal" href="#sample-generators">6.3. Sample generators</a></li>
<li><a class="reference internal" href="#datasets-in-svmlight-libsvm-format">6.4. Datasets in svmlight / libsvm format</a></li>
<li><a class="reference internal" href="#the-olivetti-faces-dataset">6.5. The Olivetti faces dataset</a></li>
<li><a class="reference internal" href="#the-20-newsgroups-text-dataset">6.6. The 20 newsgroups text dataset</a><ul>
<li><a class="reference internal" href="#usage">6.6.1. Usage</a></li>
<li><a class="reference internal" href="#examples">6.6.2. Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#downloading-datasets-from-the-mldata-org-repository">6.7. Downloading datasets from the mldata.org repository</a></li>
<li><a class="reference internal" href="#the-labeled-faces-in-the-wild-face-recognition-dataset">6.8. The Labeled Faces in the Wild face recognition dataset</a><ul>
<li><a class="reference internal" href="#id5">6.8.1. Usage</a></li>
<li><a class="reference internal" href="#id6">6.8.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        

        <h3>Citing</h3>
        <p>Please consider
	<a href="about.html#citing-the-scikit-learn">citing the
	scikit-learn</a>.
        </div>

      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="dataset-loading-utilities">
<span id="datasets"></span><h1>6. Dataset loading utilities<a class="headerlink" href="#dataset-loading-utilities" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">sklearn.datasets</span></tt> package embeds some small toy datasets
as introduced in the &#8220;Getting Started&#8221; section.</p>
<p>To evaluate the impact of the scale of the dataset (<tt class="docutils literal"><span class="pre">n_samples</span></tt> and
<tt class="docutils literal"><span class="pre">n_features</span></tt>) while controlling the statistical properties of the data
(typically the correlation and informativeness of the features), it is
also possible to generate synthetic data.</p>
<p>This package also features helpers to fetch larger datasets commonly
used by the machine learning community to benchmark algorithm on data
that comes from the &#8216;real world&#8217;.</p>
<div class="section" id="toy-datasets">
<h2>6.1. Toy datasets<a class="headerlink" href="#toy-datasets" title="Permalink to this headline">¶</a></h2>
<p>scikit-learn comes with a few small standard datasets that do not
require to download any file from some external website.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston" title="sklearn.datasets.load_boston"><tt class="xref py py-obj docutils literal"><span class="pre">load_boston</span></tt></a>()</td>
<td>Load and return the boston house-prices dataset (regression).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_iris.html#sklearn.datasets.load_iris" title="sklearn.datasets.load_iris"><tt class="xref py py-obj docutils literal"><span class="pre">load_iris</span></tt></a>()</td>
<td>Load and return the iris dataset (classification).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_diabetes.html#sklearn.datasets.load_diabetes" title="sklearn.datasets.load_diabetes"><tt class="xref py py-obj docutils literal"><span class="pre">load_diabetes</span></tt></a>()</td>
<td>Load and return the diabetes dataset (regression).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_digits.html#sklearn.datasets.load_digits" title="sklearn.datasets.load_digits"><tt class="xref py py-obj docutils literal"><span class="pre">load_digits</span></tt></a>([n_class])</td>
<td>Load and return the digits dataset (classification).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_linnerud.html#sklearn.datasets.load_linnerud" title="sklearn.datasets.load_linnerud"><tt class="xref py py-obj docutils literal"><span class="pre">load_linnerud</span></tt></a>()</td>
<td>Load and return the linnerud dataset (multivariate regression).</td>
</tr>
</tbody>
</table>
<p>These datasets are useful to quickly illustrate the behavior of the
various algorithms implemented in the scikit. They are however often too
small to be representative of real world machine learning tasks.</p>
</div>
<div class="section" id="sample-images">
<h2>6.2. Sample images<a class="headerlink" href="#sample-images" title="Permalink to this headline">¶</a></h2>
<p>The scikit also embed a couple of sample JPEG images published under Creative
Commons license by their authors. Those image can be useful to test algorithms
and pipeline on 2D data.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">load_sample_images</span></tt>()</td>
<td>Load sample images for image manipulation.</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-obj docutils literal"><span class="pre">load_sample_image</span></tt>(image_name)</td>
<td>Load the numpy array of a single sample image</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The default coding of images is based on the <tt class="docutils literal"><span class="pre">uint8</span></tt> dtype to
spare memory.  Often machine learning algorithms work best if the
input is converted to a floating point representation first.  Also,
if you plan to use <tt class="docutils literal"><span class="pre">pylab.imshow</span></tt> don&#8217;t forget to scale to the range
0 - 1 as done in the following example.</p>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><a class="reference internal" href="../auto_examples/cluster/plot_color_quantization.html#example-cluster-plot-color-quantization-py"><em>Color Quantization using K-Means</em></a></li>
</ul>
</div>
</div>
<div class="section" id="sample-generators">
<span id="id1"></span><h2>6.3. Sample generators<a class="headerlink" href="#sample-generators" title="Permalink to this headline">¶</a></h2>
<p>In addition, scikit-learn includes various random sample generators that
can be used to build artifical datasets of controled size and complexity.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><tt class="xref py py-obj docutils literal"><span class="pre">make_classification</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;...])</td>
<td>Generate a random n-class classification problem.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_regression.html#sklearn.datasets.make_regression" title="sklearn.datasets.make_regression"><tt class="xref py py-obj docutils literal"><span class="pre">make_regression</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;...])</td>
<td>Generate a random regression problem.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_blobs.html#sklearn.datasets.make_blobs" title="sklearn.datasets.make_blobs"><tt class="xref py py-obj docutils literal"><span class="pre">make_blobs</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;centers,&nbsp;...])</td>
<td>Generate isotropic Gaussian blobs for clustering.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_friedman1.html#sklearn.datasets.make_friedman1" title="sklearn.datasets.make_friedman1"><tt class="xref py py-obj docutils literal"><span class="pre">make_friedman1</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;...])</td>
<td>Generate the &#8220;Friedman #1&#8221; regression problem as described in Friedman [1]</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_friedman2.html#sklearn.datasets.make_friedman2" title="sklearn.datasets.make_friedman2"><tt class="xref py py-obj docutils literal"><span class="pre">make_friedman2</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate the &#8220;Friedman #2&#8221; regression problem as described in Friedman [1]</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_friedman3.html#sklearn.datasets.make_friedman3" title="sklearn.datasets.make_friedman3"><tt class="xref py py-obj docutils literal"><span class="pre">make_friedman3</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate the &#8220;Friedman #3&#8221; regression problem as described in Friedman [1]</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_low_rank_matrix.html#sklearn.datasets.make_low_rank_matrix" title="sklearn.datasets.make_low_rank_matrix"><tt class="xref py py-obj docutils literal"><span class="pre">make_low_rank_matrix</span></tt></a>([n_samples,&nbsp;...])</td>
<td>Generate a mostly low rank random matrix with bell-shaped singular values profile.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_sparse_coded_signal.html#sklearn.datasets.make_sparse_coded_signal" title="sklearn.datasets.make_sparse_coded_signal"><tt class="xref py py-obj docutils literal"><span class="pre">make_sparse_coded_signal</span></tt></a>(n_samples,&nbsp;...[,&nbsp;...])</td>
<td>Generate a signal as a sparse combination of dictionary elements.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_sparse_uncorrelated.html#sklearn.datasets.make_sparse_uncorrelated" title="sklearn.datasets.make_sparse_uncorrelated"><tt class="xref py py-obj docutils literal"><span class="pre">make_sparse_uncorrelated</span></tt></a>([n_samples,&nbsp;...])</td>
<td>Generate a random regression problem with sparse uncorrelated design as</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_spd_matrix.html#sklearn.datasets.make_spd_matrix" title="sklearn.datasets.make_spd_matrix"><tt class="xref py py-obj docutils literal"><span class="pre">make_spd_matrix</span></tt></a>(n_dim[,&nbsp;random_state])</td>
<td>Generate a random symmetric, positive-definite matrix.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_swiss_roll.html#sklearn.datasets.make_swiss_roll" title="sklearn.datasets.make_swiss_roll"><tt class="xref py py-obj docutils literal"><span class="pre">make_swiss_roll</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate a swiss roll dataset.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_s_curve.html#sklearn.datasets.make_s_curve" title="sklearn.datasets.make_s_curve"><tt class="xref py py-obj docutils literal"><span class="pre">make_s_curve</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate an S curve dataset.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="datasets-in-svmlight-libsvm-format">
<span id="libsvm-loader"></span><h2>6.4. Datasets in svmlight / libsvm format<a class="headerlink" href="#datasets-in-svmlight-libsvm-format" title="Permalink to this headline">¶</a></h2>
<p>scikit-learn includes a fast utility function, <tt class="docutils literal"><span class="pre">load_svmlight_format</span></tt>,  to load
datasets in the svmlight / libsvm format. In this format, each line
takes the form <tt class="docutils literal"><span class="pre">&lt;label&gt;</span> <span class="pre">&lt;feature-id&gt;:&lt;feature-value&gt;</span>
<span class="pre">&lt;feature-id&gt;:&lt;feature-value&gt;</span> <span class="pre">...</span></tt>. This format is especially suitable for sparse datasets.
Scipy sparse CSR matrices are used for <tt class="docutils literal"><span class="pre">X</span></tt> and numpy arrays are used for <tt class="docutils literal"><span class="pre">y</span></tt>.</p>
<p>You may load a dataset like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_svmlight_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_svmlight_file</span><span class="p">(</span><span class="s">&quot;/path/to/train_dataset.txt&quot;</span><span class="p">)</span>
<span class="gp">... </span>                                                        
</pre></div>
</div>
<p>You may also load two datasets at once:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">load_svmlight_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&quot;/path/to/train_dataset.txt&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&quot;/path/to/test_dataset.txt&quot;</span><span class="p">)</span>                        
</pre></div>
</div>
<p>In this case, <tt class="docutils literal"><span class="pre">X_train</span></tt> and <tt class="docutils literal"><span class="pre">X_test</span></tt> are guaranteed to have the same number
of features. Another way to achieve the same result is to fix the number of
features:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">load_svmlight_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&quot;/path/to/test_dataset.txt&quot;</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">... </span>                                                        
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Public datasets:</p>
<p><span class="target" id="public-datasets-in-svmlight-libsvm-format">Public datasets in svmlight / libsvm format</span>: <a class="reference external" href="http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/">http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/</a></p>
</div>
</div>
<div class="section" id="the-olivetti-faces-dataset">
<span id="olivetti-faces"></span><h2>6.5. The Olivetti faces dataset<a class="headerlink" href="#the-olivetti-faces-dataset" title="Permalink to this headline">¶</a></h2>
<p>This dataset contains a set of face images taken between April 1992 and April
1994 at AT&amp;T Laboratories Cambridge. The website describing the original
dataset is now defunct, but archived copies can be accessed through
<a class="reference external" href="http://wayback.archive.org/web/*/http://www.uk.research.att.com/facedatabase.html">the Internet Archive&#8217;s Wayback Machine</a>.</p>
<p>As described on the original website:</p>
<blockquote>
<div>There are ten different images of each of 40 distinct subjects. For some
subjects, the images were taken at different times, varying the lighting,
facial expressions (open / closed eyes, smiling / not smiling) and facial
details (glasses / no glasses). All the images were taken against a dark
homogeneous background with the subjects in an upright, frontal position (with
tolerance for some side movement).</div></blockquote>
<p>The image is quantized to 256 grey levels and stored as unsigned 8-bit integers;
the loader will convert these to floating point values on the interval [0, 1],
which are easier to work with for many algorithms.</p>
<p>The &#8220;target&#8221; for this database is an integer from 0 to 39 indicating the
identity of the person pictured; however, with only 10 examples per class, this
relatively small dataset is more interesting from an unsupervised or
semi-supervised perspective.</p>
<p>The original dataset consisted of 92 x 112, while the version available here
consists of 64x64 images.</p>
<p>When using these images, please give credit to AT&amp;T Laboratories Cambridge.</p>
</div>
<div class="section" id="the-20-newsgroups-text-dataset">
<h2>6.6. The 20 newsgroups text dataset<a class="headerlink" href="#the-20-newsgroups-text-dataset" title="Permalink to this headline">¶</a></h2>
<p>The 20 newsgroups dataset comprises around 18000 newsgroups posts on
20 topics splitted in two subsets: one for training (or development)
and the other one for testing (or for performance evaluation). The split
between the train and test set is based upon a messages posted before
and after a specific date.</p>
<p>The 20 newsgroups dataset is also available through the generic
<tt class="docutils literal"><span class="pre">mldata</span></tt> dataset loader introduced earlier. However mldata
provides a version where the data is already vectorized.</p>
<p>This is not the case for this loader. Instead, it returns the list of
the raw text files that can be fed to  text feature extractors such as
<tt class="xref py py-class docutils literal"><span class="pre">sklearn.feature_extraction.text.Vectorizer</span></tt> with custom
parameters so as to extract feature vectors.</p>
<div class="section" id="usage">
<h3>6.6.1. Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">sklearn.datasets.fetch_20newsgroups</span></tt> function is a data
fetching / caching functions that downloads the data archive from
the original <a class="reference external" href="http://people.csail.mit.edu/jrennie/20Newsgroups/">20 newsgroups website</a>, extracts the archive contents
in the <tt class="docutils literal"><span class="pre">~/scikit_learn_data/20news_home</span></tt> folder and calls the
<tt class="docutils literal"><span class="pre">sklearn.datasets.load_file</span></tt> on either the training or
testing set folder, or both of them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">))</span>
<span class="go">[&#39;alt.atheism&#39;,</span>
<span class="go"> &#39;comp.graphics&#39;,</span>
<span class="go"> &#39;comp.os.ms-windows.misc&#39;,</span>
<span class="go"> &#39;comp.sys.ibm.pc.hardware&#39;,</span>
<span class="go"> &#39;comp.sys.mac.hardware&#39;,</span>
<span class="go"> &#39;comp.windows.x&#39;,</span>
<span class="go"> &#39;misc.forsale&#39;,</span>
<span class="go"> &#39;rec.autos&#39;,</span>
<span class="go"> &#39;rec.motorcycles&#39;,</span>
<span class="go"> &#39;rec.sport.baseball&#39;,</span>
<span class="go"> &#39;rec.sport.hockey&#39;,</span>
<span class="go"> &#39;sci.crypt&#39;,</span>
<span class="go"> &#39;sci.electronics&#39;,</span>
<span class="go"> &#39;sci.med&#39;,</span>
<span class="go"> &#39;sci.space&#39;,</span>
<span class="go"> &#39;soc.religion.christian&#39;,</span>
<span class="go"> &#39;talk.politics.guns&#39;,</span>
<span class="go"> &#39;talk.politics.mideast&#39;,</span>
<span class="go"> &#39;talk.politics.misc&#39;,</span>
<span class="go"> &#39;talk.religion.misc&#39;]</span>
</pre></div>
</div>
<p>The real data lies in the <tt class="docutils literal"><span class="pre">filenames</span></tt> and <tt class="docutils literal"><span class="pre">target</span></tt> attributes. The target
attribute is the integer index of the category:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(11314,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(11314,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">array([12,  6,  9,  8,  6,  7,  9,  2, 13, 19])</span>
</pre></div>
</div>
<p>It is possible to load only a sub-selection of the categories by passing the
list of the categories to load to the <tt class="docutils literal"><span class="pre">fetch_20newsgroups</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;alt.atheism&#39;</span><span class="p">,</span> <span class="s">&#39;sci.space&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">cats</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="go">[&#39;alt.atheism&#39;, &#39;sci.space&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1073,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1073,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">array([1, 1, 1, 0, 1, 0, 0, 1, 1, 1])</span>
</pre></div>
</div>
<p>In order to feed predictive or clustering models with the text data,
one first need to turn the text into vectors of numerical values suitable
for statistical analysis. This can be achieved with the utilities of the
<tt class="docutils literal"><span class="pre">sklearn.feature_extraction.text</span></tt> as demonstrated in the following
example that extract <a class="reference external" href="http://en.wikipedia.org/wiki/Tf-idf">TF-IDF</a> vectors of unigram tokens:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">Vectorizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">documents</span> <span class="o">=</span> <span class="p">[</span><span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">filenames</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">Vectorizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1073, 21108)</span>
</pre></div>
</div>
<p>The extracted TF-IDF vectors are very sparse with an average of 118 non zero
components by sample in a more than 20000 dimensional space (less than 1% non
zero features):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span><span class="o">.</span><span class="n">nnz</span> <span class="o">/</span> <span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">118</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h3>6.6.2. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../auto_examples/grid_search_text_feature_extraction.html#example-grid-search-text-feature-extraction-py"><em>Sample pipeline for text feature extraction and evaluation</em></a></p>
<p><a class="reference internal" href="../auto_examples/document_classification_20newsgroups.html#example-document-classification-20newsgroups-py"><em>Classification of text documents using sparse features</em></a></p>
</div>
</div>
<div class="section" id="downloading-datasets-from-the-mldata-org-repository">
<span id="mldata"></span><h2>6.7. Downloading datasets from the mldata.org repository<a class="headerlink" href="#downloading-datasets-from-the-mldata-org-repository" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://mldata.org">mldata.org</a> is a public repository for machine learning
data, supported by the <a class="reference external" href="http://www.pascal-network.org">PASCAL network</a> .</p>
<p>The <tt class="docutils literal"><span class="pre">sklearn.datasets</span></tt> package is able to directly download data
sets from the repository using the function <tt class="docutils literal"><span class="pre">fetch_mldata(dataname)</span></tt>.</p>
<p>For example, to download the MNIST digit recognition database:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_mldata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mnist</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;MNIST original&#39;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
</pre></div>
</div>
<p>The MNIST database contains a total of 70000 examples of handwritten digits
of size 28x28 pixels, labeled from 0 to 9:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(70000, 784)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mnist</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(70000,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="go">array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.])</span>
</pre></div>
</div>
<p>After the first download, the dataset is cached locally in the path
specified by the <tt class="docutils literal"><span class="pre">data_home</span></tt> keyword argument, which defaults to
<tt class="docutils literal"><span class="pre">~/scikit_learn_data/</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">custom_data_home</span><span class="p">,</span> <span class="s">&#39;mldata&#39;</span><span class="p">))</span>
<span class="go">[&#39;mnist-original.mat&#39;]</span>
</pre></div>
</div>
<p>Data sets in <a class="reference external" href="http://mldata.org">mldata.org</a> do not adhere to a strict
naming or formatting convention. <tt class="docutils literal"><span class="pre">fetch_mldata</span></tt> is able to make sense
of the most common cases, but allows to tailor the defaults to individual
datasets:</p>
<ul>
<li><p class="first">The data arrays in <a class="reference external" href="http://mldata.org">mldata.org</a> are most often
shaped as <tt class="docutils literal"><span class="pre">(n_features,</span> <span class="pre">n_samples)</span></tt>. This is the opposite of the
<tt class="docutils literal"><span class="pre">scikit-learn</span></tt> convention, so <tt class="docutils literal"><span class="pre">fetch_mldata</span></tt> transposes the matrix
by default. The <tt class="docutils literal"><span class="pre">transpose_data</span></tt> keyword controls this behavior:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;iris&#39;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(150, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;iris&#39;</span><span class="p">,</span> <span class="n">transpose_data</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 150)</span>
</pre></div>
</div>
</li>
<li><p class="first">For datasets with multiple columns, <tt class="docutils literal"><span class="pre">fetch_mldata</span></tt> tries to identify
the target and data columns and rename them to <tt class="docutils literal"><span class="pre">target</span></tt> and <tt class="docutils literal"><span class="pre">data</span></tt>.
This is done by looking for arrays named <tt class="docutils literal"><span class="pre">label</span></tt> and <tt class="docutils literal"><span class="pre">data</span></tt> in the
dataset, and failing that by choosing the first array to be <tt class="docutils literal"><span class="pre">target</span></tt>
and the second to be <tt class="docutils literal"><span class="pre">data</span></tt>. This behavior can be changed with the
<tt class="docutils literal"><span class="pre">target_name</span></tt> and <tt class="docutils literal"><span class="pre">data_name</span></tt> keywords, setting them to a specific
name or index number (the name and order of the columns in the datasets
can be found at its <a class="reference external" href="http://mldata.org">mldata.org</a> under the tab &#8220;Data&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">iris2</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;datasets-UCI iris&#39;</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris3</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;datasets-UCI iris&#39;</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="s">&#39;class&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">data_name</span><span class="o">=</span><span class="s">&#39;double0&#39;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="the-labeled-faces-in-the-wild-face-recognition-dataset">
<span id="labeled-faces-in-the-wild"></span><h2>6.8. The Labeled Faces in the Wild face recognition dataset<a class="headerlink" href="#the-labeled-faces-in-the-wild-face-recognition-dataset" title="Permalink to this headline">¶</a></h2>
<p>This dataset is a collection of JPEG pictures of famous people collected
over the internet, all details are available on the official website:</p>
<blockquote>
<div><a class="reference external" href="http://vis-www.cs.umass.edu/lfw/">http://vis-www.cs.umass.edu/lfw/</a></div></blockquote>
<p>Each picture is centered on a single face. The typical task is called
Face Verification: given a pair of two pictures, a binary classifier
must predict whether the two images are from the same person.</p>
<p>An alternative task, Face Recognition or Face Identification is:
given the picture of the face of an unknown person, identify the name
of the person by referring to a gallery of previously seen pictures of
identified persons.</p>
<p>Both Face Verification and Face Recognition are tasks that are typically
performed on the output of a model trained to perform Face Detection. The
most popular model for Face Detection is called Viola-Johns and is
implemented in the OpenCV library. The LFW faces were extracted by this
face detector from various online websites.</p>
<div class="section" id="id5">
<h3>6.8.1. Usage<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">scikit-learn</span></tt> provides two loaders that will automatically download,
cache, parse the metadata files, decode the jpeg and convert the
interesting slices into memmaped numpy arrays. This dataset size is more
than 200 MB. The first load typically takes more than a couple of minutes
to fully decode the relevant part of the JPEG files into numpy arrays. If
the dataset has  been loaded once, the following times the loading times
less than 200ms by using a memmaped version memoized on the disk in the
<tt class="docutils literal"><span class="pre">~/scikit_learn_data/lfw_home/</span></tt> folder using <tt class="docutils literal"><span class="pre">joblib</span></tt>.</p>
<p>The first loader is used for the Face Identification task: a multi-class
classification task (hence supervised learning):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_lfw_people</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span> <span class="o">=</span> <span class="n">fetch_lfw_people</span><span class="p">(</span><span class="n">min_faces_per_person</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">lfw_people</span><span class="o">.</span><span class="n">target_names</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">name</span>
<span class="gp">...</span>
<span class="go">Ariel Sharon</span>
<span class="go">Colin Powell</span>
<span class="go">Donald Rumsfeld</span>
<span class="go">George W Bush</span>
<span class="go">Gerhard Schroeder</span>
<span class="go">Hugo Chavez</span>
<span class="go">Tony Blair</span>
</pre></div>
</div>
<p>The default slice is a rectangular shape around the face, removing
most of the background:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float32&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1288, 50, 37)</span>
</pre></div>
</div>
<p>Each of the <tt class="docutils literal"><span class="pre">1140</span></tt> faces is assigned to a single person id in the <tt class="docutils literal"><span class="pre">target</span></tt>
array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1288,)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">lfw_people</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[5, 6, 3, 1, 0, 1, 3, 4, 3, 0]</span>
</pre></div>
</div>
<p>The second loader is typically used for the face verification task: each sample
is a pair of two picture belonging or not to the same person:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_lfw_pairs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span> <span class="o">=</span> <span class="n">fetch_lfw_pairs</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="go">[&#39;Different persons&#39;, &#39;Same person&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2200, 2, 62, 47)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2200,)</span>
</pre></div>
</div>
<p>Both for the <tt class="docutils literal"><span class="pre">fetch_lfw_people</span></tt> and <tt class="docutils literal"><span class="pre">fetch_lfw_pairs</span></tt> function it is
possible to get an additional dimension with the RGB color channels by
passing <tt class="docutils literal"><span class="pre">color=True</span></tt>, in that case the shape will be
<tt class="docutils literal"><span class="pre">(2200,</span> <span class="pre">2,</span> <span class="pre">62,</span> <span class="pre">47,</span> <span class="pre">3)</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">fetch_lfw_pairs</span></tt> datasets is subdived in 3 subsets: the development
<tt class="docutils literal"><span class="pre">train</span></tt> set, the development <tt class="docutils literal"><span class="pre">test</span></tt> set and an evaluation <tt class="docutils literal"><span class="pre">10_folds</span></tt>
set meant to compute performance metrics using a 10-folds cross
validation scheme.</p>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><a class="reference external" href="http://vis-www.cs.umass.edu/lfw/lfw.pdf">Labeled Faces in the Wild: A Database for Studying Face Recognition
in Unconstrained Environments.</a>
Gary B. Huang, Manu Ramesh, Tamara Berg, and Erik Learned-Miller.
University of Massachusetts, Amherst, Technical Report 07-49, October, 2007.</li>
</ul>
</div>
</div>
<div class="section" id="id6">
<h3>6.8.2. Examples<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../auto_examples/applications/face_recognition.html#example-applications-face-recognition-py"><em>Faces recognition example using eigenfaces and SVMs</em></a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
        <p style="text-align: center">This documentation is relative
        to scikit-learn version 0.9<p>
        &copy; 2010–2011, scikit-learn developers (BSD License).
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2. Design by <a href="http://webylimonada.com">Web y Limonada</a>.
    <span style="padding-left: 5ex;">
    <a href="../_sources/datasets/index.txt"
	    rel="nofollow">Show this page source</a>
    </span>
    </div>
  </body>
</html>